<app-header
  headerTitle="Alunos"
  headerMarginTop="{{headerMarginTop}}"
  (refreshEvent)="getEbdStudents()"
  [selectOptions]="loggedUserHasFullAccess ? { placeholder: 'Selecione uma classe', items: (ebdClasses$ | async), defaultAll: 'Todas as classes', choosedItem: loggedUserPreferredClass } : null"
  (selectEvent)="loggedUserHasFullAccess ? onSelectClass($event) : null"
  [searchbarOptions]="searchbarOptions"
  (searchEvent)="onFilterStudents($event)"
></app-header>

<ion-content
  [fullscreen]="true"
  [scrollEvents]="true"
  (ionScroll)="onContentScroll($event)"
>
  <app-student-history
    [student]="selectedStudent"
    [studentHistoryList]="ebdStudentHistoryList$ | async"
    (dismissModalEvent)="selectedStudent=null"
  ></app-student-history>

  <!-- <ng-container *ngIf="ebdStudents$ | async as ebdStudents; else loadingTemplate">
    <ion-virtual-scroll [items]="ebdStudents" approxItemHeight="69px">
      <div *virtualItem="let item; let itemBounds = bounds;">
        <ion-item *ngIf="!filteredName || item?.name?.toLowerCase()?.includes(filteredName?.toLowerCase())" button lines="full" (click)="selectedStudent = item; getEbdStudentHistory(item.id)">
          <ion-avatar slot="start">
            <img [src]="item?.picture || '/assets/img/person.png'" />
          </ion-avatar>
          <ion-label>
            <h3>{{item?.name}}</h3>
            <p>{{item?.ebd_class ? 'Classe ' + item?.ebd_class : 'Sem Classe'}}</p>
          </ion-label>
        </ion-item>
      </div>
    </ion-virtual-scroll>
  </ng-container> -->

  <ion-list *ngIf="ebdStudents$ | async as ebdStudents; else loadingTemplate">
    <ng-container *ngFor="let student of ebdStudents">
      <ion-item *ngIf="!filteredName || student?.name?.toLowerCase()?.includes(filteredName?.toLowerCase())" button lines="full" (click)="selectedStudent = student; getEbdStudentHistory(student.id)">
        <ion-avatar slot="start">
          <img [src]="student?.picture || '/assets/img/person.png'" />
        </ion-avatar>
        <ion-label>
          <h3>{{student?.name}}</h3>
          <p>{{student?.ebd_class ? 'Classe ' + student?.ebd_class : 'Sem Classe'}}</p>
        </ion-label>
      </ion-item>
    </ng-container>
  </ion-list>

  <ng-template #loadingTemplate>
    <ion-progress-bar type="indeterminate"></ion-progress-bar>
  </ng-template>
</ion-content>